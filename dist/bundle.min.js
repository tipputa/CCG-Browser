var bio=function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(n,!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){console.log(t),console.log(this.v)}for(var p,g=function(t){function e(){var t;return n(this,e),(t=h(this,c(e).call(this))).v="a",t.name="new name",t.echo=f,t}return u(e,t),o(e,[{key:"get",value:function(){return this.v}}]),e}(function(){function t(){n(this,t),this.name="my name"}return o(t,[{key:"echoName",value:function(){console.log(this.name)}}]),t}()),m=function(t){console.log(t)},v=Object.keys,d=Math.pow(2,53)-1,y=(p="length",function(t){return null==t?void 0:t[p]}),b=function(t){if(!function(t){var n=e(t);return"function"===n||"object"===n&&!!t}(t))return[];if(v)return v(t);var n=[];for(var i in t)has(t,i)&&n.push(i);return n},w=function(t,e,n){var i,o;if(e=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,i,o){return console.log(e),t.call(e,n,i,o)};case 4:return function(n,i,o,s){return t.call(e,n,i,o,s)}}return function(){return t.apply(e,arguments)}}(e,n),function(t){var e=y(t);return"number"==typeof e&&e>=0&&e<=d}(t))for(i=0,o=t.length;i<o;i++)e(t[i],i,t);else{var s=b(t);for(i=0,o=s.length;i<o;i++)e(t[s[i]],s[i],t)}return t},P=function(){function t(e){n(this,t),this.elements=e,this.mouse=null}return o(t,[{key:"on",value:function(t,e,n){var i=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return w(this.elements,(function(s){s.addEventListener(t,(function(){var t=s.getBoundingClientRect();i.mouse=[event.clientX-t.left-s.clientLeft,event.clientY-t.top-s.clientTop],e.call(n),i.mouse=null}),o)})),this}},{key:"create",value:function(e){var n=[];return w(this.elements,(function(t){var i=document.createElement(e);t.appendChild(i),n.push(t.lastElementChild)})),new t(n)}},{key:"style",value:function(t,e){return w(this.elements,(function(n){n.style.setProperty(t,e)})),this}},{key:"attr",value:function(t,e){return w(this.elements,(function(n){n.setAttribute(t,e)})),this}},{key:"setClass",value:function(t){return this.attr("class",t)}},{key:"setID",value:function(t){return this.attr("id",t)}},{key:"html",value:function(t){if(1!=arguments.length){var e=[];return w(this.elements,(function(t){e.push(t.textContent)})),1===e.length?e[0]:e}if(!t)return w(this.elements,(function(e){e.textContent=t})),this;w(this.elements,(function(e){e.textContent=t}))}}]),t}(),q=function(t){return new P([document.getElementById(t)])},O=function(t,e,n){var i,o,s,r=n*e,a=t/60,u=r*(1-Math.abs(a%2-1));0<=a&&a<1?(i=r,o=u,s=0):1<=a&&a<2?(i=u,o=r,s=0):2<=a&&a<3?(i=0,o=r,s=u):3<=a&&a<4?(i=0,o=u,s=r):4<=a&&a<5?(i=u,o=0,s=r):5<=a&&a<6&&(i=r,o=0,s=u);var c=n-r,l=[i+c,o+c,s+c];return i=l[0],o=l[1],s=l[2],[i=Math.floor(255*i),o=Math.floor(255*o),s=Math.floor(255*s)]},S=[],_=1;_>=.5;_-=.1)for(var x=1;x>=.5;x-=.25)for(var C=0;C<360;C++)S.push("rgb("+O(C,x,_).join(",")+")");var k=function(t){return S[12*t]},j=function(t,e){return S[t*e]},D={};D.A=k(0),D.B=k(1),D.C=k(2),D.D=k(3),D.E=k(4),D.F=k(5),D.G=k(6),D.H=k(7),D.I=k(8),D.J=k(9),D.K=k(10),D.L=k(11),D.M=k(12),D.N=k(13),D.O=k(14),D.P=k(15),D.Q=k(16),D.R=k(17),D.S=k(18),D.T=k(19),D.U=k(20),D.V=k(21),D.W=k(22),D.X=k(23),D.Y=k(24),D.Z=k(25),D["-"]="rgb(200,200,200)";var z=function t(){n(this,t),this.height=500,this.width=500,this.mainCanvas=null,this.isDragging=!1},E={width:0,height:0,left:0,top:0,right:0,bottom:0},I={fontSize:13},M={id:"def",setSize:!1,height:600,width:600,seqHeight:12,isGrouping:!0,header:a({},E,{},I,{height:50}),label:a({},E,{},I,{fontSize:9,left:10,top:0,width:200}),sequence:a({},E,{},I,{fontSize:9,left:10,top:3,width:480,topMargin:0,bottomMargin:0})},H=function t(e){n(this,t),this.start=0,this.end=e,this.size=e},T=function(t){function e(){var t;return n(this,e),(t=h(this,c(e).call(this))).container=null,t.inputJson=null,t.options=a({},M),t.numSeq=0,t.group=null,t.canvasHeight=0,t.headerContainer=null,t.bodyContainer=null,t.labelContainer=null,t.canvasContainer=null,t.ctx=null,t.alignmentPosition=null,t.baseWidth=0,t}return u(e,t),o(e,[{key:"setContainer",value:function(t){this.container=q(t),this.options.id=t,this.options.setSize?(this.height=this.options.height,this.width=this.options.width):(this.width=this.container.elements[0].clientWidth,this.height=this.container.elements[0].clientHeight)}},{key:"setJson",value:function(t){this.inputJson=t,this.numSeq=t.sequences.length,this.canvasHeight=this.numSeq*this.options.seqHeight+50,this.alignmentPosition=new H(t.sequences[0].seq.length)}},{key:"render",value:function(){var t=this;this.options.isGrouping&&function(){t.group=function(t){var e={},n=0;return w(t,(function(t,i,o){t.group in e?(e[t.group].count++,e[t.group].names.push(t.name)):e[t.group]={count:1,col:j(n++,45),names:[t.name]}})),e}(t.inputJson.sequences);var e=0,n=function(n){w(t.inputJson.sequences,(function(t){t.group===n&&(t.order=e++)}))};for(var i in t.group)n(i)}(),this._DOMcreate(),this._drawSequences()}},{key:"_DOMcreate",value:function(){var t=this;this.options.sequence.width=this.width-this.options.label.width-this.options.label.left-this.options.sequence.left-this.options.sequence.right,this.headerContainer=this.container.create("div").setID("".concat(this.options.id,"_header")),this.bodyContainer=this.container.create("div").setID("".concat(this.options.id,"_body")).style("position","relative"),this.canvasContainer=this.bodyContainer.create("div").setID("".concat(this.options.id,"_canvasContainer")).style("position","relative").style("height","".concat(this.canvasHeight,"px")),this.mainCanvas=this.canvasContainer.create("canvas").setID("".concat(this.options.id,"_canvas")).style("position","absolute").style("left",this.options.label.width+this.options.label.left+this.options.sequence.left+"px").style("top",this.options.sequence.top+"px").attr("height",this.canvasHeight).attr("width",this.options.sequence.width),this.mainCanvas.on("mousemove",(function(){event.preventDefault(),t.isDragging&&t._move(event.movementX)})).on("mousewheel",(function(){event.preventDefault(),event.deltaY>0?t._zoomOut():event.deltaY<0&&t._zoomIn()})).on("mousedown",(function(){event.preventDefault(),0==event.button&&(t.isDragging=!0)})).on("mouseup",(function(){event.preventDefault(),0==event.button&&(t.isDragging=!1)})).on("mouseout",(function(){t.isDragging=!1})).on("dblclick",(function(){t._zoomIn()})),this.ctx=this.mainCanvas.elements[0].getContext("2d"),w(this.inputJson.sequences,(function(e){t._drawSequenceLabel(e)}))}},{key:"_drawSequences",value:function(){var t,e,n,i=this;t=this.ctx,e=this.options.sequence.width,n=this.canvasHeight,t.clearRect(0,0,e,n);var o=this.options.seqHeight-this.options.sequence.topMargin-this.options.sequence.bottomMargin;!function(t,e){t.lineWidth=e}(this.ctx,o),w(this.inputJson.sequences,(function(t,e){i._drawSequence(t,e)}))}},{key:"_drawSequence",value:function(t){var e=this,n=this.options.seqHeight*(t.order+1)+this.options.sequence.topMargin,i=t.seq.substr(this.alignmentPosition.start,parseInt(this.alignmentPosition.end-this.alignmentPosition.start)).split("");this.baseWidth=this.options.sequence.width/i.length,this.baseWidth<10?w(i,(function(t,i){var o,s,r,a,u,c;o=e.ctx,s=i*e.baseWidth,r=(i+1)*e.baseWidth,a=n,u=n,c=D[t],o.beginPath(),o.moveTo(s,a),o.lineTo(r,u),o.strokeStyle=c,o.stroke()})):w(i,(function(t,i){e.ctx.beginPath(),e.ctx.font=e.options.sequence.fontSize+"px Arial serif",e.ctx.moveTo(i*e.baseWidth,n),e.ctx.lineTo((i+1)*e.baseWidth,n),e.ctx.strokeStyle=D[t],e.ctx.fillStyle="black",e.ctx.textAlign="center",e.ctx.stroke(),e.ctx.fillText(t,i*e.baseWidth+e.baseWidth/2,n+.33*e.options.sequence.fontSize)}))}},{key:"_drawSequenceLabel",value:function(t){var e=this.options.seqHeight*(t.order+1)-this.options.label.fontSize/2;this.bodyContainer.create("div").style("position","absolute").style("top",e+"px").style("font-size",this.options.label.fontSize+"px").style("color",this.group[t.group].col).html(t.name+"_"+t.group)}},{key:"_zoomIn",value:function(){this.alignmentPosition.end-this.alignmentPosition.start>30&&(this.alignmentPosition.start+=5,this.alignmentPosition.end-=5),this._drawSequences()}},{key:"_zoomOut",value:function(){0==this.alignmentPosition.start&&this.alignmentPosition.end==this.alignmentPosition.size||(this.alignmentPosition.start-=5,this.alignmentPosition.end+=5,this.alignmentPosition.start<0&&(this.alignmentPosition.start=0),this.alignmentPosition.end>this.alignmentPosition.size&&(this.alignmentPosition.end=this.alignmentPosition.size),this._drawSequences())}},{key:"_move",value:function(t){var e=10;if(e=t>10?10:5,t<0){if(this.alignmentPosition.start+=e,this.alignmentPosition.end+=e,this.alignmentPosition.end>this.alignmentPosition.size){var n=this.alignmentPosition.end-this.alignmentPosition.size;this.alignmentPosition.start-=n,this.alignmentPosition.end-=n}}else this.alignmentPosition.start-=e,this.alignmentPosition.end-=e,this.alignmentPosition.start<0&&(this.alignmentPosition.start=0,this.alignmentPosition.end+=e);this._drawSequences()}}]),e}(z);return t.Alignment=T,t.COLER_ARR=S,t.GraphicBase=g,t.PROTEIN_COL_V1=D,t.each=w,t.func=m,t.getColors=j,t.json=function(t,e){return fetch(t,e).then((function(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.json()}))},t.select=function(t){return new P([document.querySelector(t)])},t.selectAll=function(t){return new P(document.querySelectorAll(t))},t.selectClass=function(t){return new P([document.getElementsByClassName(t)])},t.selectID=q,t.text=function(t,e){return fetch(t,e).then((function(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}))},t}({});
//# sourceMappingURL=bundle.min.js.map
