var bio=function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(i,!0).forEach((function(e){o(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(i).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}for(var r,l=Object.prototype.hasOwnProperty,c=function(t,e){return null!=t&&l.call(t,e)},u=Object.keys,g=Math.pow(2,53)-1,d=(r="length",function(t){return null==t?void 0:t[r]}),p=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 3:return function(i,n,s){return console.log(e),t.call(e,i,n,s)};case 4:return function(i,n,s,o){return t.call(e,i,n,s,o)}}return function(){return t.apply(e,arguments)}},f=function(t){if(!function(t){var i=e(t);return"function"===i||"object"===i&&!!t}(t))return[];if(u)return u(t);var i=[];for(var n in t)c(t,n)&&i.push(n);return i},m=function(t,e,i){var n,s;if(e=p(e,i),function(t){var e=d(t);return"number"==typeof e&&e>=0&&e<=g}(t))for(n=0,s=t.length;n<s;n++)e(t[n],n,t);else{var o=f(t);for(n=0,s=o.length;n<s;n++)e(t[o[n]],o[n],t)}return t},v=function(t,e){return function(i,n,s){var o=e?[[],[]]:{};return n=p(n,s),m(i,(function(e,s){var a=n(e,s,i);t(o,e,a)})),o}},y=v((function(t,e,i){c(t,i)?t[i].push(e):t[i]=[e]})),b=v((function(t,e,i){c(t,i)?t[i]++:t[i]=1})),w=v((function(t,e,i){t[i]=e})),S=function(t){var e=[];return function(t){for(var i=0;i<t;i++)e.push({})}(t[0].seq.length),m(t,(function(t){var i,n;i=t.seq,n=i.split(""),m(n,(function(t,i){t in e[i]?e[i][t]++:e[i][t]=1}))})),e},x=function(t){var e=[];return m(t,(function(t){t.hasOwnProperty("-")?e.push(!1):e.push(!0)})),e},_=function(t){var e=0;return m(t,(function(t){t.hasOwnProperty("-")||e++})),e},q=function(t,e){var i=[];return m(t,(function(t){t.hasOwnProperty("-")?i.push(t["-"]/e):i.push(0)})),i},C=function(t,e){var i=[];return m(t,(function(t){var n={},s=0;m(t,(function(t,i){var o=-1*t/e*Math.log2(t/e);n[i]=o,s+=o})),n.Entropy=Math.log2(22)-s,m(n,(function(i,s){"Entropy"!==s&&(n[s]=n.Entropy*t[s]/e)})),i.push(n)})),i},P=function(t){var e=[],i={},n=0;return m(t,(function(t,i){t>.1&&"Entropy"!==i&&(e.push({name:i,value:t}),n+=t)})),e.sort((function(t,e){return e.value-t.value})),i.sum=n,i.res=e,i},k=function(t,e){var i=[];return t.length!==e.length?(console.log("not match: "+t.length+" "+e.length),i):(m(t,(function(t,n){e[n]&&i.push(t)})),i)},R=function(t){var e=[];return m(t,(function(t){e.push(">"+t.name),e.push(t.seq)})),e.join("\n")},z=function(t,e){var i=[];return m(t,(function(t){var n=k(t.seq.split(""),e);i.push(">"+t.name),i.push(n.join(""))})),i.join("\n")},I=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i(this,t),this.elements=e,this.mouse=null,this.isSvgChild=n}return s(t,[{key:"on",value:function(t,e,i){var n=this,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return m(this.elements,(function(o){o.addEventListener(t,(function(){var t=o.getBoundingClientRect();n.mouse=[event.clientX-t.left-o.clientLeft,event.clientY-t.top-o.clientTop],e.call(i),n.mouse=null}),s)})),this}},{key:"create",value:function(e){var i=this,n=[],s=!1;return m(this.elements,(function(t){if("svg"==e||i.isSvgChild){var o=document.createElementNS("http://www.w3.org/2000/svg",e);t.appendChild(o),n.push(o),s=!0}else{var a=document.createElement(e);t.appendChild(a),n.push(a)}})),new t(n,s)}},{key:"remove",value:function(){m(this.elements,(function(t){t.parentNode.removeChild(t)}))}},{key:"removeChild",value:function(t){m(this.elements,(function(e){e.removeChild(t)}))}},{key:"style",value:function(t,e){return m(this.elements,(function(i){i.style.setProperty(t,e)})),this}},{key:"attr",value:function(t,e){return m(this.elements,(function(i){i.setAttribute(t,e)})),this}},{key:"setClass",value:function(t){return this.attr("class",t)}},{key:"setID",value:function(t){return this.attr("id",t)}},{key:"html",value:function(t){if(1!=arguments.length){var e=[];return m(this.elements,(function(t){e.push(t.textContent)})),1===e.length?e[0]:e}if(!t)return m(this.elements,(function(e){e.textContent=t})),this;m(this.elements,(function(e){e.textContent=t}))}},{key:"innerHTML",value:function(t){if(1!=arguments.length){var e=[];return m(this.elements,(function(t){e.push(t.innerHTML)})),1===e.length?e[0]:e}if(!t)return m(this.elements,(function(e){e.innerHTML=t})),this;m(this.elements,(function(e){e.innerHTML=t}))}}]),t}(),D=function(t){return new I([document.getElementById(t)])},M=function(t){return new I([document.querySelector(t)])},G=function(t){return new I(document.querySelectorAll(t))},H=function(t,e){return fetch(t,e).then((function(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.json()}))},L={A:"#ccff00",R:"#0000ff",N:"#cc00ff",D:"#ff0000",C:"#ffff00",Q:"#ff00cc",E:"#ff0066",G:"#ff9900",H:"#0066ff",I:"#66ff00",L:"#33ff00",K:"#6600ff",M:"#00ff00",F:"#00ff66",P:"#ffcc00",S:"#ff3300",T:"#ff6600",W:"#00ccff",Y:"#00ffcc",V:"#99ff00",B:"#fff",X:"#fff",Z:"#fff","-":"rgb(200,200,200)","\\":"rgb(200,200,200)"},W=function(t,e,i){var n,s,o,a=i*e,h=t/60,r=a*(1-Math.abs(h%2-1));0<=h&&h<1?(n=a,s=r,o=0):1<=h&&h<2?(n=r,s=a,o=0):2<=h&&h<3?(n=0,s=a,o=r):3<=h&&h<4?(n=0,s=r,o=a):4<=h&&h<5?(n=r,s=0,o=a):5<=h&&h<6&&(n=a,s=0,o=r);var l=i-a,c=[n+l,s+l,o+l];return n=c[0],s=c[1],o=c[2],[n=Math.floor(255*n),s=Math.floor(255*s),o=Math.floor(255*o)]},A=[],J=1;J>=.5;J-=.1)for(var O=1;O>=.5;O-=.25)for(var T=0;T<360;T++)A.push("rgb("+W(T,O,J).join(",")+")");var E=function(t){return A[12*t]},B=function(t,e){return A[t*e]},j={};j.A=E(0),j.B=E(1),j.C=E(2),j.D=E(3),j.E=E(4),j.F=E(5),j.G=E(6),j.H=E(7),j.I=E(8),j.J=E(9),j.K=E(10),j.L=E(11),j.M=E(12),j.N=E(13),j.O=E(14),j.P=E(15),j.Q=E(16),j.R=E(17),j.S=E(18),j.T=E(19),j.U=E(20),j.V=E(21),j.W=E(22),j.X=E(23),j.Y=E(24),j.Z=E(25),j["-"]="rgb(200,200,200)";var Y={A:" #64F73F",C:" #FFB340",G:" #EB413C",T:" #3C88EE",U:" #3C88EE"},X=function(t,e){var i=document.createElement("a");return i.download=t,i.href=e,i},F=function(t,e){var i=new Blob([t],{type:"type/plain"}),n=window.URL.createObjectURL(i);X(e,n).click()},Z=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,s=new Blob([JSON.stringify(t,i,n)],{type:"application/json"}),o=window.URL.createObjectURL(s);X(e,o).click()},N=function(){function t(){i(this,t),this.x=100,this.y=100,this.layerX=0,this.layerY=0,this.width=100,this.height=200,this.modal_class="def-modal-class"}return s(t,[{key:"makeModal",value:function(){var t=this,e=M("body").on("dragover",(function(){event.preventDefault(),console.log(event)})).create("div").style("position","absolute").style("left",this.x+"px").style("top",this.y+"px").style("height",this.height+"px").style("width",this.width+"px").style("z-index",10).style("background-color","rgb(255,0,0)");e.create("div").attr("draggable","true").style("position","relative").style("height","30px").style("width",this.width+"px").setClass(this.modal_class).style("background-color","rgb(200,200,200)").on("dragend",(function(){e.style("left",event.pageX-t.layerX+"px").style("top",event.pageY-t.layerY+"px")})).on("dragstart",(function(){t.layerX=event.layerX,t.layerY=event.layerY,console.log(event),event.dataTransfer.setDragImage(t.box,0,0)}));e.create("div").style("position","relative").style("background-color","rgb(20,0,0)").style("width",this.width).style("height","200px")}}]),t}(),U={width:0,height:0,left:0,top:0,right:0,bottom:0},K={fontSize:13},V={id:"def",setSize:!1,height:600,width:600,seqHeight:25,isGrouping:!0,colorScheme:L,header:h({},U,{},K,{height:100,top:10,enable:!0}),seqLogo:{enable:!0},nonGapRate:{enable:!0,left:10,top:10,bottom:0,baseColor:"rgb(120,120,120)",highColor:"rgb(30, 30, 250)",th:1},label:h({},U,{},K,{fontSize:13,left:10,top:0,width:300}),sequence:h({},U,{},K,{fontSize:12,left:10,right:10,top:0,width:480,topMargin:0,bottomMargin:0}),scaleBar:h({},K,{fontSize:13,height:40,enable:!0})},Q=Math.PI/2,$=function(t,e){t.lineWidth=e},tt=function(t,e){t.textAlign=e},et=function(t,e){t.fillStyle=e},it=function(t,e,i,n,s,o){t.beginPath(),t.moveTo(e,n),t.lineTo(i,s),t.strokeStyle=o,t.stroke()},nt=function(t,e,i,n,s,o,a){var h=a<0?"rgba(200,200,200)":A[a];t.beginPath(),t.arc(e,i,n,s-Q,o-Q),t.strokeStyle=h,t.stroke()},st=function(t,e,i,n,s){t.font=s,t.fillText(e,i,n)},ot=function(t,e,i){t.clearRect(0,0,e,i)},at=function(){function t(e){i(this,t),this.start=0,this.end=e,this.size=e,this.preStart=-1,this.preEnd=-1}return s(t,[{key:"update",value:function(t){this.start=0,this.end=t,this.size=t,this.preStart=-1,this.preEnd=-1}}]),t}(),ht=function(){function t(e,n){i(this,t),this.height=500,this.width=500,this.mainCanvas=null,this.isDragging=!1,this.id=e,this.container=null,this.inputJson=null,this.options=h({},V,{},n),this.numSeq=0,this.group=null,this.canvasHeight=0,this.headerContainer=null,this.bodyContainer=null,this.labelContainer=null,this.labelDiv=null,this.canvasContainer=null,this.ctx=null,this.alignmentPosition=null,this.baseWidth=0,this.seqLength=0,this.orderedAlignments=null,this.highlightedIndicies=null,this.isConservedRegionMode=!1,this.conservedRegionBooleanArr=null,this.conservedRegionLength=0,this.headerCanvas=null,this.headerCtx=null,this.seqStat=null,this.gapRate=null,this.shannonEntropyArr=null}return s(t,[{key:"setContainer",value:function(t){this.container=D(t),this.container.html(""),this.options.id=t,this.options.setSize?(this.height=this.options.height,this.width=this.options.width):(this.width=this.container.elements[0].clientWidth,this.height=this.container.elements[0].clientHeight)}},{key:"setJson",value:function(t){var e=this;this.inputJson=t,this.numSeq=t.sequences.length,this.canvasHeight=this.numSeq*this.options.seqHeight+50,this.seqLength=this.inputJson.sequences[0].seq.length,this.alignmentPosition=new at(this.seqLength),this.seqStat=S(this.inputJson.sequences),this.conservedRegionBooleanArr=x(this.seqStat),this.conservedRegionLength=_(this.seqStat),this.gapRate=q(this.seqStat,this.numSeq),this.shannonEntropyArr=C(this.seqStat,this.numSeq),this.options.isGrouping&&function(){e.group=function(t){var e={},i=0;return m(t,(function(t,n,s){t.group in e?(e[t.group].count++,e[t.group].names.push(t.name)):e[t.group]={count:1,col:B(i++,45),names:[t.name]}})),e}(e.inputJson.sequences);var t=0,i=function(i){m(e.inputJson.sequences,(function(e){e.group===i&&(e.order=t++)}))};for(var n in e.group)i(n)}(),this.orderedAlignments=new Array(this.inputJson.sequences.length),m(this.inputJson.sequences,(function(t){e.orderedAlignments[t.order]=t}))}},{key:"render",value:function(){this._DOMcreate(),this.ctx=this.mainCanvas.elements[0].getContext("2d"),this._initHeader(),this._drawSequenceLabel(),this.drawSequences()}},{key:"zoomInShowSequence",value:function(){this.alignmentPosition.end-this.alignmentPosition.start<20||(this.alignmentPosition.preStart=this.alignmentPosition.start,this.alignmentPosition.preEnd=this.alignmentPosition.end,this.alignmentPosition.start=0,this.alignmentPosition.end=30,this.drawSequences())}},{key:"change2conservedRegion",value:function(){this.isConservedRegionMode=!0,this.alignmentPosition.update(this.conservedRegionLength),this.drawSequences()}},{key:"change2allRegion",value:function(){this.isConservedRegionMode=!1,this.alignmentPosition.update(this.seqLength),this.drawSequences()}},{key:"saveRawJson",value:function(){Z(this.inputJson,"all_rawJson_".concat(this.id,".json"))}},{key:"saveAllSequence",value:function(){F(R(this.inputJson.sequences),"all_alignments_".concat(this.id,".fas"))}},{key:"saveConservedRegion",value:function(){F(z(this.inputJson.sequences,this.conservedRegionBooleanArr),"conservedRegion_alignments_".concat(this.id,".fas"))}},{key:"saveVisualizedRegion",value:function(){var t=this;if(this.isConservedRegionMode){var e=[];m(this.inputJson.sequences,(function(i){var n=k(i.seq.split(""),t.conservedRegionBooleanArr).slice(parseInt(t.alignmentPosition.start+.5),parseInt(t.alignmentPosition.end+.5)).join("");e.push({name:i.name,seq:n})})),F(R(e),"visualizedRegion_conserved_".concat(this.id,".fas"))}else{var i=[];m(this.inputJson.sequences,(function(e){var n=e.seq.substr(parseInt(t.alignmentPosition.start+.5),parseInt(t.alignmentPosition.end+.5)-parseInt(t.alignmentPosition.start+.5));i.push({name:e.name,seq:n})})),F(R(i),"visualizedRegion_".concat(this.id,".fas"))}}},{key:"_DOMcreate",value:function(){var t=this;this.options.sequence.width=this.width-this.options.label.width-this.options.label.left-this.options.sequence.left-this.options.sequence.right,this.headerContainer=this.container.create("div").setID("".concat(this.options.id,"_header")),this.bodyContainer=this.container.create("div").setID("".concat(this.options.id,"_body")).style("position","relative").setClass("d-flex flex-row"),this.canvasContainer=this.bodyContainer.create("div").setID("".concat(this.options.id,"_canvasContainer")).style("position","relative").style("height","".concat(this.canvasHeight,"px")),this.labelContainer=this.bodyContainer.create("div").setID("".concat(this.options.id,"_label")).style("margin-left","".concat(this.options.label.left,"px")).style("margin-top",this.options.label.top+this.options.scaleBar.height+"px"),this.mainCanvas=this.canvasContainer.create("canvas").setID("".concat(this.options.id,"_canvas")).style("position","absolute").style("left",this.options.label.width+this.options.label.left+"px").style("top",this.options.sequence.top+"px").attr("height",this.canvasHeight).attr("width",this.width-this.options.label.width-this.options.label.left),this.mainCanvas.on("mousemove",(function(){event.preventDefault(),t.isDragging&&t._move(event.movementX/window.devicePixelRatio)})).on("mousewheel",(function(){event.preventDefault(),event.deltaY>0?t._zoomOut():event.deltaY<0&&t._zoomIn()})).on("mousedown",(function(){event.preventDefault(),0==event.button&&(t.isDragging=!0)})).on("mouseup",(function(){event.preventDefault(),0==event.button&&(t.isDragging=!1)})).on("mouseout",(function(){t.isDragging=!1})).on("dblclick",(function(){t._resetZoom()}))}},{key:"_initHeader",value:function(){this.options.header.enable&&(this.headerCanvas=this.headerContainer.style("position","relative").style("height",this.options.header.height+2+"px").create("canvas").attr("height",this.options.header.height+2+"px").attr("width",this.width).style("position","absolute"),this.headerCtx=this.headerCanvas.elements[0].getContext("2d"),this.options.header.left=this.options.sequence.left+this.options.label.width+this.options.label.left+this.options.label.right)}},{key:"_updateSortInfo",value:function(t){var e=t.toArray();m(this.inputJson.sequences,(function(t){t.order=e.indexOf(t.name)})),this.drawSequences()}},{key:"drawSequences",value:function(){var t=this;ot(this.ctx,this.width,this.canvasHeight);var e=this.options.seqHeight-this.options.sequence.topMargin-this.options.sequence.bottomMargin;$(this.ctx,e),tt(this.ctx,"center"),m(this.inputJson.sequences,(function(e){t._drawSequence(e)})),this._drawHighlightRect(),this._drawScaleBar(),this._drawHeader()}},{key:"_drawSequence",value:function(t){var e=this,i=this.options.seqHeight-this.options.sequence.topMargin-this.options.sequence.bottomMargin,n=this.options.scaleBar.height+this.options.seqHeight*(t.order+1)+this.options.sequence.topMargin-i/2,s=[];this.isConservedRegionMode?s=k(t.seq.split(""),this.conservedRegionBooleanArr).slice(parseInt(this.alignmentPosition.start+.5),parseInt(this.alignmentPosition.end+.5)):s=t.seq.substr(parseInt(this.alignmentPosition.start+.5),parseInt(this.alignmentPosition.end+.5)-parseInt(this.alignmentPosition.start+.5)).split("");if(0!=s.length){var o=s.length;this.baseWidth=this.options.sequence.width/o,et(this.ctx,"black"),this.ctx.font=this.options.sequence.fontSize+"px Arial serif",this.baseWidth<10?m(s,(function(t,i){it(e.ctx,e.options.sequence.left+i*e.baseWidth,e.options.sequence.left+(i+1)*e.baseWidth,n,n,e.options.colorScheme[t])})):m(s,(function(t,i){it(e.ctx,e.options.sequence.left+i*e.baseWidth,e.options.sequence.left+(i+1)*e.baseWidth,n,n,e.options.colorScheme[t]),e.ctx.fillText(t,e.options.sequence.left+i*e.baseWidth+e.baseWidth/2,n+.33*e.options.sequence.fontSize)}))}}},{key:"_drawSequenceLabel",value:function(){var t=this;m(this.orderedAlignments,(function(e,i){t.options.seqHeight;t.labelDiv=t.labelContainer.create("div").attr("data-id",e.name).style("font-size",t.options.label.fontSize+"px").style("color",t.group[e.group].col).style("height",t.options.seqHeight+"px");var n=t.labelDiv.create("p").style("margin","0").style("height",t.options.seqHeight+"px");n.create("span").setClass("handle fas fa-expand-arrows-alt").html(" "),n.elements[0].innerHTML+=e.name+"_"+e.group}))}},{key:"_drawHighlightRect",value:function(){var t=this;m(this.highlightedIndicies,(function(e){var i=e.index,n=t.options.scaleBar.height+t.options.seqHeight*i+t.options.sequence.topMargin;!function(t,e,i,n,s,o,a){t.beginPath(),t.strokeStyle=o,t.lineWidth=a,t.strokeRect(e,i,n,s)}(t.ctx,t.options.sequence.left,n,t.options.sequence.width,t.options.seqHeight,"red",3)}))}},{key:"_drawScaleBar",value:function(){if(this.options.scaleBar.enable){$(this.ctx,1.5);var t=this.alignmentPosition.start,e=this.alignmentPosition.end,i=e-t,n=this.options.sequence.width>500?10:5,s=parseInt(i/n);n=parseInt(i/s),i<30&&this.baseWidth>20&&(n=i,s=1);for(var o=this.options.sequence.left,a=this.options.scaleBar.height-this.options.scaleBar.fontSize/2,h=0;h<n;h++)o=this.options.sequence.left+h*s*this.baseWidth+this.baseWidth/2,st(this.ctx,parseInt(t+h*s+.5+1),o,a,this.options.scaleBar.fontSize+"px Arial serif"),it(this.ctx,o,o,this.options.scaleBar.height,a+1,"grey");1!==s&&(o=this.options.sequence.left+parseInt(i+.5)*this.baseWidth-this.baseWidth/2,st(this.ctx,parseInt(e),o,a,this.options.scaleBar.fontSize+"px Arial serif"),it(this.ctx,o,o,this.options.scaleBar.height,a+1,"grey"))}}},{key:"_drawHeader",value:function(){if(this.options.header.enable){ot(this.headerCtx,this.width,this.options.header.height),this._drawNonGrapRate(),this._drawSeqLogo(),$(this.headerCtx,1),i=this.headerCtx,n="black",i.strokeStyle=n;var t=this.options.header.left,e=this.options.header.top;it(this.headerCtx,t-10,t-10,this.options.header.height+1,e),it(this.headerCtx,this.width-1,this.width-1,this.options.header.height+1,e),it(this.headerCtx,t-10,this.width,e,e),it(this.headerCtx,t-10,this.width,this.options.header.height+1,this.options.header.height+1)}var i,n}},{key:"_drawSeqLogo",value:function(){var t=this;if(this.options.seqLogo.enable&&this.baseWidth>10){tt(this.headerCtx,"center"),et(this.headerCtx,"black"),this.headerCtx.rotate(3*Math.PI/2),st(this.headerCtx,"bits",-this.options.header.height/2,this.options.header.left-35,"14px sans-serif"),this.headerCtx.rotate(1*Math.PI/2),tt(this.headerCtx,"right"),st(this.headerCtx,"0",this.options.header.left-14,this.options.header.height,"12px sans-serif"),st(this.headerCtx,"4.5",this.options.header.left-14,this.options.header.top+6,"12px sans-serif"),$(this.headerCtx,1),tt(this.headerCtx,"center"),this.headerCtx.font="900 "+30*(this.options.header.height-this.options.header.top)/100+'px "Arial Black", Arial, Gadget, sans-serif';var e=Math.log2(22),i=this.options.header.height-this.options.header.top-1,n=i/e,s=this.options.header.left,o=this.options.header.top+1,a=this.baseWidth,h=[];h=this.isConservedRegionMode?k(this.shannonEntropyArr,this.conservedRegionBooleanArr):this.shannonEntropyArr,m(h,(function(h,r){if(r>=parseInt(t.alignmentPosition.start+.5)&&r<=parseInt(t.alignmentPosition.end+.5-1)){var l=P(h),c=i*(1-l.sum/e);m(l.res,(function(h){var l=h.name.replace("-","\\"),u=i*h.value/e,g=u/n;t.headerCtx.transform(1,0,0,g,s+a/2+a*(r-parseInt(t.alignmentPosition.start+.5)),o+u+c),t.headerCtx.fillStyle=L[l],t.headerCtx.fillText(l,0,0,a),t.headerCtx.setTransform(1,0,0,1,0,0),c=u+c}))}}))}}},{key:"_drawNonGrapRate",value:function(){var t=this;if(this.options.nonGapRate.enable&&this.baseWidth<=10&&!this.isConservedRegionMode){tt(this.headerCtx,"center"),et(this.headerCtx,"black"),this.headerCtx.rotate(3*Math.PI/2),st(this.headerCtx,"1 - gap rate",-this.options.header.height/2,this.options.header.left-35,"14px sans-serif"),this.headerCtx.rotate(1*Math.PI/2),tt(this.headerCtx,"right"),st(this.headerCtx,"0",this.options.header.left-14,this.options.header.height,"12px sans-serif"),st(this.headerCtx,"1",this.options.header.left-14,this.options.header.top+6,"12px sans-serif"),tt(this.headerCtx,"center"),$(this.headerCtx,this.baseWidth);var e=this.options.header.height,i=this.options.header.height-this.options.header.top-1;m(this.gapRate,(function(n,s){if(s>=parseInt(t.alignmentPosition.start+.5)&&s<=parseInt(t.alignmentPosition.end+.5-1)){var o=t.options.header.left+(s-parseInt(t.alignmentPosition.start+.5))*t.baseWidth+.5*t.baseWidth;it(t.headerCtx,o,o,e,e-i*(1-n),1-n>=t.options.nonGapRate.th?t.options.nonGapRate.highColor:t.options.nonGapRate.baseColor)}}))}}},{key:"_zoomIn",value:function(){var t=this.baseWidth<5?20:this.baseWidth<10?10:5;this.alignmentPosition.end-this.alignmentPosition.start>30?(this.alignmentPosition.start+=t,this.alignmentPosition.end-=t,this.drawSequences()):this.alignmentPosition.end-this.alignmentPosition.start>10?(this.alignmentPosition.start+=2,this.alignmentPosition.end-=2,this.drawSequences()):this.alignmentPosition.end-this.alignmentPosition.start>2&&(this.alignmentPosition.start+=1,this.alignmentPosition.end-=1,this.drawSequences())}},{key:"_zoomOut",value:function(){if(this.alignmentPosition.end-this.alignmentPosition.start<30)this.alignmentPosition.start-=2,this.alignmentPosition.end+=2;else{var t=this.baseWidth<5?20:this.baseWidth<10?10:5;if(0==this.alignmentPosition.start&&this.alignmentPosition.end==this.alignmentPosition.size)return;this.alignmentPosition.start-=t,this.alignmentPosition.end+=t,this.alignmentPosition.start<0&&(this.alignmentPosition.start=0),this.alignmentPosition.end>this.alignmentPosition.size&&(this.alignmentPosition.end=this.alignmentPosition.size)}this.drawSequences()}},{key:"_move",value:function(t){if(0!==t){var e=t/this.baseWidth;this.alignmentPosition.start-=e,this.alignmentPosition.end-=e,this.alignmentPosition.end>this.alignmentPosition.size&&(this.alignmentPosition.start+=e,this.alignmentPosition.end=this.alignmentPosition.size),this.alignmentPosition.start<0&&(this.alignmentPosition.start=0,this.alignmentPosition.end+=e),parseInt(this.alignmentPosition.start+.5)===parseInt(this.alignmentPosition.preStart+.5)&&parseInt(this.alignmentPosition.end-this.alignmentPosition.start+.5)===parseInt(this.alignmentPosition.preEnd-this.alignmentPosition.preStart+.5)||(this.alignmentPosition.preStart=this.alignmentPosition.start,this.alignmentPosition.preEnd=this.alignmentPosition.end,this.drawSequences())}}},{key:"_resetZoom",value:function(){this.alignmentPosition.preStart=this.alignmentPosition.start,this.alignmentPosition.preEnd=this.alignmentPosition.end,this.alignmentPosition.start=0,this.alignmentPosition.end=this.alignmentPosition.size,this.drawSequences()}}]),t}(),rt={elementId:"def",setSize:!1,height:600,width:600,outerRadius:400,innnerRadius:20,ringMargin:0,highlighterEnable:!0},lt=function(){function t(e){i(this,t),this.options=h({},rt,{},e),this.container=null,this.width=0,this.height=0,this.halfX=0,this.halfY=0,this.inputJson=null,this.numGenomes=null,this.maxRadius=0,this.ringSize=0,this.highlightCanvas=null,this.highlighter=null}return s(t,[{key:"setContainer",value:function(t){console.log("load element: "+t),this.container=D(t),this.container.html(""),this.options.elementId=t,this.options.setSize?(this.height=this.options.height,this.width=this.options.width):(this.width=this.container.elements[0].clientWidth,this.height=this.container.elements[0].clientHeight,this.options.outerRadius=this.width/2-50),this.canvasHeight=this.width,this.halfX=this.width/2,this.halfY=this.canvasHeight/2}},{key:"setJson",value:function(t){this.inputJson=t,this.numGenomes=t.genomes.length}},{key:"render",value:function(){this._DOMcreate(),this.ctx=this.mainCanvas.elements[0].getContext("2d"),this.options.highlighterEnable&&(this.highlighter=new ct(this.highlightCanvas,this.width,this.canvasHeight,this.inputJson)),this.drawCircularGenomes()}},{key:"_DOMcreate",value:function(){this.bodyContainer=this.container.create("div").setID("".concat(this.options.elementId,"_body")).style("position","relative").setClass("d-flex flex-row"),this.canvasContainer=this.bodyContainer.create("div").setID("".concat(this.options.elementId,"_canvasContainer")).style("height","".concat(this.canvasHeight,"px")),this.mainCanvas=this.canvasContainer.create("canvas").style("position","absolute").style("top","0").setID("".concat(this.options.elementId,"_canvas")).attr("height",this.canvasHeight).attr("width",this.width).style("left","0"),this.highlightCanvas=this.canvasContainer.create("canvas").setID("".concat(this.options.elementId,"_highlight_canvas")).attr("height",this.canvasHeight).attr("width",this.width).style("position","absolute").style("top","0").style("left","0")}},{key:"redrawCircularGenomes",value:function(){this._drawKaryotype(),ot(this.ctx,this.width,this.canvasHeight),this._drawCircularGenomes()}},{key:"drawCircularGenomes",value:function(){this._init_radius(),ot(this.ctx,this.width,this.canvasHeight),this._drawKaryotype(),this._drawCircularGenomes()}},{key:"_init_radius",value:function(){this.ringSize=(this.options.outerRadius-(this.numGenomes-1)*this.options.ringMargin-this.options.innnerRadius)/this.numGenomes,this.ringSize<0&&(this.options.ringMargin=1,this.ringSize=(this.options.outerRadius-(this.numGenomes-1)*this.options.ringMargin-this.options.innnerRadius)/this.numGenomes),this.ringSize<0&&(this.options.ringMargin=0,this.ringSize=(this.options.outerRadius-this.options.innnerRadius)/this.numGenomes),console.log("Ring size: "+this.ringSize),console.log("this.options.ringMargin:",this.options.ringMargin),this.maxRadius=this.options.outerRadius+this.ringSize/2,this.highlighter&&(this.highlighter.maxRadius=this.maxRadius+10);for(var t=0;t<this.numGenomes;t++)this.inputJson.genomes[t].r=this.options.outerRadius-this.inputJson.genomes[t].order*(this.ringSize+this.options.ringMargin)}},{key:"_drawCircularGenomes",value:function(){$(this.ctx,this.ringSize);for(var t=0;t<this.numGenomes;t++)for(var e=0;e<this.inputJson.genomes[t].genes.length;e++)Math.abs(this.inputJson.genomes[t].genes[e].start_rotated_rad-this.inputJson.genomes[t].genes[e].end_rotated_rad)<1&&nt(this.ctx,this.halfX,this.halfY,this.inputJson.genomes[t].r,this.inputJson.genomes[t].genes[e].start_rotated_rad,this.inputJson.genomes[t].genes[e].end_rotated_rad,this.inputJson.genomes[t].genes[e].angle)}},{key:"_drawKaryotype",value:function(){$(this.ctx,5);for(var t=0;t<360;t++)nt(this.ctx,this.halfX,this.halfY,this.maxRadius,this.convertDeg2Rad(t),this.convertDeg2Rad(t+1),t)}},{key:"convertDeg2Rad",value:function(t){return 2*Math.PI*t/360}}]),t}(),ct=function(){function t(e,n,s,o){i(this,t),this.canvas=e,this.width=n,this.height=s,this.halfX=this.width/2,this.halfY=this.height/2,this.maxRadius=0,this.ctx=this.canvas.elements[0].getContext("2d"),this.inputJson=o,this.isHighlightLock=!1,this.zoomSize=.1,this.updateFunction=null,this.zoomStart=0,this.zoomEnd=0,this._init()}return s(t,[{key:"clear",value:function(){ot(this.ctx,this.width,this.height)}},{key:"showArc",value:function(t,e){this.clear(),this.setLineWidth(5),this.ctx.beginPath(),this.ctx.moveTo(this.halfX,this.halfY),this.ctx.arc(this.halfX,this.halfY,this.maxRadius,t,e),this.ctx.fillStyle="rgba(50,50,50,0.5)",this.ctx.strokeStyle="rgba(50,50,50, 0.7)",this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke(),this.ctx.restore()}},{key:"showArcRegions",value:function(t,e,i,n){this.ctx.beginPath(),this.ctx.arc(this.halfX,this.halfY,t+e/2,i,n),this.ctx.lineTo(this.halfX+(t-e/2)*Math.cos(n),this.halfY+(t-e/2)*Math.sin(n)),this.ctx.arc(this.halfX,this.halfY,t-e/2,n,i,!0),this.ctx.lineTo(this.halfX+(t+e/2)*Math.cos(i),this.halfY+(t+e/2)*Math.sin(i)),this.ctx.stroke(),this.ctx.fill()}},{key:"setLineWidth",value:function(t){$(this.ctx,t)}},{key:"setUpdateFunction",value:function(t){this.updateFunction=t}},{key:"_init",value:function(){var t=this;this.canvas.on("mousemove",(function(){if(!t.isHighlightLock){var e=t.canvas.mouse,i=t._getAngleFromMousePosition(e);t.zoomStart=i-t.zoomSize,t.zoomEnd=i+t.zoomSize,t.showArc(t.zoomStart,t.zoomEnd)}})).on("mouseleave",(function(){t.isHighlightLock||t.clear()})).on("dblclick",(function(){event.preventDefault()})).on("click",(function(){event.preventDefault(),t.isHighlightLock?t.isHighlightLock=!1:(t.isHighlightLock=!0,t.updateFunction&&t.updateFunction(t.zoomStart,t.zoomEnd))}))}},{key:"_getAngleFromMousePosition",value:function(t){var e=t[0]-this.halfX,i=(t[1]-this.halfX)/e,n=Math.atan(i);return e<0?n+Math.PI:n}}]),t}(),ut={elementId:"def",setSize:!1,height:600,width:600,seqHeight:40,margin:4,label:{top:10,left:20,width:200},sequence:{fontSize:10,top:10,left:20,right:20,marginY:1,cdsHeight:10,genomeHeight:15},tooltip:{height:75},zoom:{xs:2,sm:10,md:50,lg:500,xl:5e3}},gt=function(){function t(){i(this,t)}return s(t,[{key:"test",value:function(){console.log("test ok")}}]),t}(),dt=function(t){return{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json; charset=utf-8"},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(t)}},pt=function(){function t(e){i(this,t),this.options=h({},ut,{},e),this.start=2600,this.end=2700,this.seqWidthRatio=1,this.alignedSizeList=[],this.genomeSizeRate=[],this.baseGenomeSize=0,this.isDragging=!1;new gt}return s(t,[{key:"setRange",value:function(t,e){this.resetAlignment(),console.log("working set range"),this.start=(t+Math.PI/2)/(2*Math.PI)*this.inputJson.consensus_genome_size,this.end=(e+Math.PI/2)/(2*Math.PI)*this.inputJson.consensus_genome_size,this.redrawCDSs()}},{key:"setContainer",value:function(t){console.log("load element: "+t),this.container=D(t),this.container.html(""),this.options.elementId=t,this.options.setSize?(this.height=this.options.height,this.width=this.options.width,this.svgWidth=this.width-this.options.label.width-this.options.label.left-this.options.sequence.left-this.options.sequence.right):(this.width=this.container.elements[0].clientWidth,this.height=this.container.elements[0].clientHeight,this.svgWidth=this.width-this.options.label.width-this.options.label.left-this.options.sequence.left-this.options.sequence.right,console.log(this.width+" "+this.svgWidth))}},{key:"setJson",value:function(t){this.inputJson=t,this.numGenomes=t.genomes.length,this.svgHeight=(this.options.seqHeight+this.options.margin)*this.numGenomes,this.resetAlignment()}},{key:"resetAlignment",value:function(){var t=this;this.baseGenomeSize=this.inputJson.consensus_genome_size,this.alignedSizeList=new Array(this.numGenomes),this.alignedSizeList.fill(0),this.genomeSizeRate=[],m(this.inputJson.genomes,(function(e){t.genomeSizeRate.push(e.genome_size/t.inputJson.consensus_genome_size)}))}},{key:"render",value:function(){this._DOMcreate(),this._initSvg(),this.drawLinearGenomes()}},{key:"drawLinearGenomes",value:function(){this._clear(),this._drawLabels(),this._drawCDSBlocks(),this._drawGenomicSequences()}},{key:"redrawCDSs",value:function(){this._clear(),this._drawCDSBlocks(),this._drawGenomicSequences()}},{key:"_DOMcreate",value:function(){this.headerContainer=this.container.create("div").setID("".concat(this.options.elementId,"_header")),this.bodyContainer=this.container.create("div").setID("".concat(this.options.elementId,"_body")).style("position","relative").setClass("d-flex flex-row"),this.canvasContainer=this.bodyContainer.create("div").setID("".concat(this.options.elementId,"_canvasContainer")).style("position","relative").style("height","".concat(this.svgHeight,"px")),this.labelContainer=this.bodyContainer.create("div").setID("".concat(this.options.elementId,"_label")).style("margin-left","".concat(this.options.label.left,"px")).style("margin-top","".concat(this.options.label.top,"px")),this.mainSvg=this.canvasContainer.create("svg").setID("".concat(this.options.elementId,"_svg")).style("position","absolute").style("left",this.options.label.width+this.options.label.left+"px").style("top",this.options.sequence.top+"px").attr("height",this.svgHeight).attr("width",this.svgWidth),this.mainSvgGroup=this.mainSvg.create("g").setID("".concat(this.options.elementId,"_svg_group")),this.tooltip=this.bodyContainer.create("div").attr("class","linear-genome-tooltip")}},{key:"_initSvg",value:function(){var t=this;this.mainSvg.on("mousemove",(function(){event.preventDefault(),t.isDragging&&t._move(event.movementX/window.devicePixelRatio)})).on("mousewheel",(function(){event.preventDefault(),event.deltaY>0?t._zoomOut():event.deltaY<0&&t._zoomIn()})).on("mousedown",(function(){event.preventDefault(),0==event.button&&(t.isDragging=!0)})).on("mouseup",(function(){event.preventDefault(),0==event.button&&(t.isDragging=!1)})).on("mouseout",(function(){t.isDragging=!1})).on("dblclick",(function(){t._resetZoom()}))}},{key:"_clear",value:function(){G("#".concat(this.options.elementId,"_canvasContainer> canvas")).remove(),this.mainSvgGroup.remove(),this.mainSvgGroup=this.mainSvg.create("g").setID("".concat(this.options.elementId,"_svg_group"))}},{key:"_drawLabels",value:function(){var t=this,e=new Array(this.inputJson.genomes.length);m(this.inputJson.genomes,(function(t){e[t.order]=t})),m(e,(function(e){t.labelDiv=t.labelContainer.create("div").attr("data-id",e.name).style("font-size",t.options.label.fontSize+"px").style("height",t.options.seqHeight+"px");var i=t.labelDiv.create("div").style("margin",t.options.margin+"px 0 0 0").style("height",t.options.seqHeight+"px").setClass("d-flex align-items-center");i.create("span").setClass("handle fas fa-expand-arrows-alt"),i.elements[0].innerHTML+="&nbsp;"+e.name}))}},{key:"_drawCDSBlocks",value:function(){var t=this;this.seqWidthRatio=this.svgWidth/(this.end-this.start),m(this.inputJson.genomes,(function(e,i){var n=parseInt(t.start*t.genomeSizeRate[i]),s=parseInt(n+(t.end-t.start)),o=(t.options.seqHeight+t.options.margin)*e.order+t.options.sequence.genomeHeight+t.options.sequence.marginY;m(e.genes,(function(a,h){t._drawCDSBlock(a,n,s,o,t.alignedSizeList[i],e.genome_size)}))}))}},{key:"_drawCDSBlock",value:function(t,e,i,n,s,o){var a=t.start_rotated+s,h=t.end_rotated+s;a>=o&&(a-=o),a<0&&(a+=o),h>=o&&(h-=o),h<0&&(h+=o);var r=0,l=0;if(!(a>h||h-a>1e5)){if(a>e&&h<i)r=this._convertGpositionToPixel(a-e),l=this._convertGpositionToPixel(h-e);else if(a<e&&h>e)r=0,l=this._convertGpositionToPixel(h-e);else{if(!(a<i&&h>i))return;r=this._convertGpositionToPixel(a-e),l=this.width-this.options.sequence.right}var c=l-r;c<0&&(c=10),-1===t.strand&&(n+=this.options.sequence.cdsHeight),this._drawSvg(r,n,c,this.options.sequence.cdsHeight,t,o,s)}}},{key:"_convertGpositionToPixel",value:function(t){return t*this.seqWidthRatio}},{key:"_drawSvg",value:function(t,e,i,n,s,o,a){var h=this,r=A[s.angle];this.mainSvgGroup.create("rect").attr("x",t).attr("y",e).attr("width",i).attr("height",n).attr("fill",r).on("mouseover",(function(){h.tooltip.style("visibility","visible").style("top",e-h.options.tooltip.height+"px").style("left",h.options.label.width+h.options.label.left+t+"px").innerHTML("<p>name : "+s.locusTag+"</p><p>id : "+s.consensusId+"</p>")})).on("mousemove",(function(){h.tooltip.style("top",e-h.options.tooltip.height+"px").style("left",h.mainSvg.mouse[0]+h.options.label.width+h.options.label.left+"px")})).on("mouseout",(function(){h.tooltip.style("visibility","hidden")})).on("mousedown",(function(){"-1"!=s.consensusId&&(h._setBaseGenomeSizeRate(o),H("http://127.0.0.1:8000/hp72/api/consensus/id/"+s.consensusId).then((function(t){m(h.inputJson.genomes,(function(e,i){e.id in t&&(h.alignedSizeList[i]=s.start_rotated+a-h._getRotateGenomicStartPosition(e,t[e.id]))})),h.redrawCDSs()})))}))}},{key:"_setBaseGenomeSizeRate",value:function(t){if(this.baseGenomeSize===this.inputJson.consensus_genome_size){this.baseGenomeSize=t,this.genomeSizeRate=[];for(var e=0;e<this.numGenomes;e++)this.genomeSizeRate.push(t/this.inputJson.consensus_genome_size)}}},{key:"_getRotateGenomicStartPosition",value:function(t,e){var i=t.flipped,n=t.rotated_length,s=t.genome_size;if(0===i){var o=e.start+n;return o>=s&&(o-=s),o}if(1===i){var a=s-e.end+n;return a<0&&(a+=s),a>=s&&(a-=s),a}}},{key:"_getOriginalGenomicStartPosition",value:function(t,e){var i=t.flipped,n=t.rotated_length,s=t.genome_size;if(0===i){var o=e.start-n;return o>=s&&(o-=s),o<0&&(o+=s),o}if(1===i){var a=s-e.end+n;return a<0&&(a+=s),a>=s&&(a-=s),a}return 0}},{key:"_drawGenomicSequences",value:function(){var t=this,e=this.end-this.start;if(console.log("regionSize:",e),this.seqWidthRatio>1){var i={seqs:[]};m(this.inputJson.genomes,(function(n,s){var o={start:parseInt(t.start*t.genomeSizeRate[s]-t.alignedSizeList[s]),end:parseInt(t.start*t.genomeSizeRate[s]+e-t.alignedSizeList[s])},a=t._getOriginalGenomicStartPosition(n,o);i.seqs.push({genome_ID:n.id,start:a,end:a+e})})),console.log('postData["seqs"]:',i.seqs),H("http://127.0.0.1:8000/hp72/api/genome/multiple",dt(i)).then((function(n){m(t.inputJson.genomes,(function(s,o){var a=i.seqs[o].start-n[s.id].start,h=n[s.id].seq.substr(a,e);1==s.flipped&&(h=t._reverseComplement(h)),"BM012B"==s.name&&(console.log("res:",n),console.log(a),console.log(i.seqs[o].start+" "+n[s.id].start),console.log(s.name+" "+i.seqs[o].start+"-"+i.seqs[o].end),console.log(s.rotated_length),console.log(s.genome_size-i.seqs[o].start-s.rotated_length),console.log("start: "+(t.start*t.genomeSizeRate[o]-t.alignedSizeList[o])),console.log(n[s.id].start)),t._drawGenomicSequence(s,o,h)}))}))}else m(this.inputJson.genomes,(function(e,i){t._drawGenomicSequence(e,i)}))}},{key:"_reverseComplement",value:function(t){return t.replace(/A/g,"Z").replace(/T/g,"A").replace(/Z/g,"T").replace(/C/g,"Z").replace(/G/g,"C").replace(/Z/g,"G").split("").reverse()}},{key:"_drawGenomicSequence",value:function(t,e,i){var n=(this.options.seqHeight+this.options.margin)*t.order+this.options.sequence.top,s=this.canvasContainer.create("canvas").setID("".concat(this.options.elementId,"_canvas_").concat(e)).style("position","absolute").style("left",this.options.label.width+this.options.label.left+"px").style("top",n+"px").attr("height",this.options.sequence.genomeHeight).attr("width",this.svgWidth).elements[0].getContext("2d"),o=this.options.sequence.genomeHeight/2;if(this.seqWidthRatio>1)if(this.seqWidthRatio>10)for(var a=0;a<i.length;a++){var h=Y[i[a]];s.beginPath(),s.font=this.options.sequence.fontSize+"px Arial serif",s.moveTo(a*this.seqWidthRatio,o),s.lineTo((a+1)*this.seqWidthRatio,o),s.lineWidth=this.options.sequence.genomeHeight,s.strokeStyle=h,s.fillStyle="black",s.textAlign="center",s.stroke(),s.fillText(i[a],a*this.seqWidthRatio+this.seqWidthRatio/2,o+5)}else for(var r=0;r<i.length;r++){var l=Y[i[r]];s.beginPath(),s.font=this.options.sequence.fontSize+"px Arial serif",s.moveTo(r*this.seqWidthRatio,o),s.lineTo((r+1)*this.seqWidthRatio,o),s.lineWidth=this.options.sequence.genomeHeight,s.strokeStyle=l,s.fillStyle="black",s.stroke()}else s.beginPath(),s.font=this.options.sequence.fontSize+"px Arial serif",s.moveTo(0,o),s.lineTo(this.svgWidth,o),s.lineWidth=this.options.sequence.genomeHeight,s.strokeStyle="rgb(150, 150, 150)",s.fillStyle="black",s.stroke(),s.textAlign="center",s.fillText("Genome Sequence",this.svgWidth/2,o+5)}},{key:"_getZoomSize",value:function(){return this.seqWidthRatio<.1?this.options.zoom.xl:this.seqWidthRatio<.5?this.options.zoom.lg:this.seqWidthRatio<1?this.options.zoom.md:this.seqWidthRatio<5?this.options.zoom.sm:this.options.zoom.xs}},{key:"_zoomIn",value:function(){var t=this._getZoomSize();this.end-this.start>100?(this.start+=t,this.end-=t,this.redrawCDSs()):this.end-this.start>10&&(this.start+=2,this.end-=2,this.redrawCDSs())}},{key:"_zoomOut",value:function(){if(this.end-this.start<30)this.start-=2,this.end+=2;else{var t=this._getZoomSize();this.start-=t,this.end+=t}this.redrawCDSs()}},{key:"_move",value:function(t){if(0!==t){var e=t/this.seqWidthRatio;this.start-=e,this.end-=e,parseInt(this.start+.5)===parseInt(this.preStart+.5)&&parseInt(this.end-this.start+.5)===parseInt(this.preEnd-this.preStart+.5)||(this.preStart=this.start,this.preEnd=this.end,this.redrawCDSs())}}},{key:"_resetZoom",value:function(){this.preStart=this.start,this.preEnd=this.end,this.start=0,this.end=this.size,this.redrawCDSs()}},{key:"_test_db_access",value:function(){var t={seqs:[]};m(this.inputJson.genomes,(function(e,i){t.seqs.push({genome_ID:e.id,start:100,end:100})})),m(this.inputJson.genomes,(function(e,i){t.seqs.push({genome_ID:e.id,start:100,end:100})})),m(this.inputJson.genomes,(function(e,i){t.seqs.push({genome_ID:e.id,start:100,end:100})})),m(this.inputJson.genomes,(function(e,i){t.seqs.push({genome_ID:e.id,start:100,end:100})})),m(this.inputJson.genomes,(function(e,i){t.seqs.push({genome_ID:e.id,start:100,end:100})}));var e,i,n=performance.now();(e="http://127.0.0.1:8000/hp72/api/genome/test",i=dt(t),fetch(e,i).then((function(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.json()}))).then((function(t){console.log(t),console.log("performance: "+(performance.now()-n))}))}}]),t}();return t.Alignment=ht,t.CLUSTAL2_COLOR={A:"#80a0f0",R:"#f01505",N:"#00ff00",D:"#c048c0",C:"#f08080",Q:"#00ff00",E:"#c048c0",G:"#f09048",H:"#15a4a4",I:"#80a0f0",L:"#80a0f0",K:"#f01505",M:"#80a0f0",F:"#80a0f0",P:"#ffff00",S:"#00ff00",T:"#00ff00",W:"#80a0f0",Y:"#15a4a4",V:"#80a0f0",B:"#fff",X:"#fff",Z:"#fff","-":"rgb(200,200,200)","\\":"rgb(200,200,200)"},t.COLER_ARR=A,t.CircularGenomeBrowser=lt,t.LinearGenomeBrowser=pt,t.Modal=N,t.NUCLEOTIDE_COLOR=Y,t.PROTEIN_COL_V1=j,t.STRAND_COLOR={A:"#5858a7",R:"#6b6b94",N:"#64649b",D:"#2121de",C:"#9d9d62",Q:"#8c8c73",E:"#0000ff",G:"#4949b6",H:"#60609f",I:"#ecec13",L:"#b2b24d",K:"#4747b8",M:"#82827d",F:"#c2c23d",P:"#2323dc",S:"#4949b6",T:"#9d9d62",W:"#c0c03f",Y:"#d3d32c",V:"#ffff00",B:"#4343bc",X:"#797986",Z:"#4747b8","-":"rgb(200,200,200)","\\":"rgb(200,200,200)"},t.SeqContainer=gt,t.TAYLOR_COLOR=L,t.calcGapRate=q,t.calcShannonEntropy=C,t.conservedRegionLength=_,t.countBy=b,t.each=m,t.exportJson=Z,t.exportSVG=function(t,e){var i,n=t;window.ActiveXObject?i=n.xml:i=(new XMLSerializer).serializeToString(n);X(e+".svg","data:image/svg+xml;utf8,"+i).click()},t.exportText=F,t.filterAndSortEntroy=P,t.generateLink=X,t.getAllSequenceAsFasta=R,t.getColors=B,t.getConservedRegionAsFasta=z,t.getTrueArr=k,t.groupBy=y,t.indexBy=w,t.isConservedRegoin=x,t.json=H,t.select=M,t.selectAll=G,t.selectClass=function(t){return new I([document.getElementsByClassName(t)])},t.selectID=D,t.seqStat=S,t.text=function(t,e){return fetch(t,e).then((function(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}))},t}({});
//# sourceMappingURL=bundle.min.js.map
